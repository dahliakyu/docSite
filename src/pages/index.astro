---
import Layout from "@layouts/Layout.astro";
import Header from "@components/Header.astro";
import Footer from "@components/Footer.astro";
import LinkButton from "@components/LinkButton.astro";
import Hr from "@components/Hr.astro";
import Card from "@components/Card";
import getSortedPosts from "@utils/getSortedPosts";
import slugify from "@utils/slugify";
import Socials from "@components/Socials.astro";
import { SOCIALS } from "@config";
import { getCollection } from "astro:content";

const posts = await getCollection("logs");
const sortedPosts = getSortedPosts(posts);

const socialCount = SOCIALS.filter(social => social.active).length;
---

<Layout>
  <Header />
  <main id="main-content">
    <section id="hero">
      <h1>HAAAAAAAI!!!!!</h1>
      <p>
        Welcome to my doc land!! This space is made with astro, adapted from the
        <LinkButton
          className="hover:text-skin-accent underline decoration-dashed"
          href="https://astro-paper.pages.dev/"
        >
          AstroPaper
        </LinkButton> and the official
        <LinkButton
          className="hover:text-skin-accent underline decoration-dashed"
          href="https://github.com/withastro/astro/tree/main/examples/docs"
        >
          Documentation
        </LinkButton> template. I will be logging some personal texts and some other
        things that I enjoy doing in my daily life. There will also be some docs
        mainly written for me to keep track of my projects. Currently working on
        documenting Vim, the making of this website and the process of building my
        own neurodata database with some dataset on
        <LinkButton
          className="hover:text-skin-accent underline decoration-dashed"
          href="https://openneuro.org/"
        >
          OpenNeuro
        </LinkButton> using PostgreSQL.
      </p>
      <p>
        ðŸ’œðŸ’œ It is cold out there, remember to eat on time and warm up yourself.
        ðŸ’œðŸ’œ
      </p>
      {
        // only display if at least one social link is enabled
        socialCount > 0 && (
          <div class="social-wrapper">
            <div class="social-links">Social Links:</div>
            <Socials />
          </div>
        )
      }
    </section>
    <div class="pt-5">
      <Hr />
    </div>
    <section id="recent-posts">
      <h2>Recent Posts</h2>
      <ul>
        {
          sortedPosts.map(
            ({ data }, index) =>
              index < 4 && (
                <Card
                  href={`/posts/${slugify(data)}`}
                  frontmatter={data}
                  secHeading={false}
                />
              )
          )
        }
      </ul>
      <div class="all-posts-btn-wrapper">
        <LinkButton href="/posts">
          All Posts
          <svg xmlns="http://www.w3.org/2000/svg"
            ><path
              d="m11.293 17.293 1.414 1.414L19.414 12l-6.707-6.707-1.414 1.414L15.586 11H6v2h9.586z"
            ></path>
          </svg>
        </LinkButton>
      </div>
    </section>
  </main>

  <Footer />
</Layout>

<style>
  /* ===== Hero Section ===== */
  #hero {
    @apply pt-8 pb-6;
  }
  #hero h1 {
    @apply my-4 inline-block text-3xl font-bold sm:my-8 sm:text-5xl;
  }
  #hero .rss-link {
    @apply mb-6;
  }
  #hero .rss-icon {
    @apply mb-2 h-6 w-6 scale-110 fill-skin-accent sm:mb-3 sm:scale-125;
  }
  #hero p {
    @apply my-2;
  }
  .social-wrapper {
    @apply mt-4 flex flex-col sm:flex-row sm:items-center;
  }
  .social-links {
    @apply mr-2 mb-1 whitespace-nowrap sm:mb-0;
  }

  /* ===== Featured & Recent Posts Sections ===== */
  #featured,
  #recent-posts {
    @apply pt-12 pb-6;
  }
  #featured h2,
  #recent-posts h2 {
    @apply text-2xl font-semibold tracking-wide;
  }
  .all-posts-btn-wrapper {
    @apply my-8 text-center;
  }
</style>
